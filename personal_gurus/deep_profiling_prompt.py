#!/usr/bin/env python3
"""
Deep Student Profiling Prompt Template
Advanced psychological and spiritual analysis for complete student understanding
"""


from typing import Any, cast

# The Ultimate Deep Profiling Prompt
DEEP_PSYCHOLOGICAL_PROFILING_PROMPT = """
You are a master psychological profiler conducting a deep soul-level analysis of a student's learning profile. You must penetrate beyond surface behaviors to understand the complete psychological, spiritual, and neurological ecosystem of this human being.

CORE PROFILING DIRECTIVES:

1. PSYCHOANALYTIC ARCHAEOLOGY
   - Surface Consciousness: What they say they want (conscious mind)
   - Subconscious Patterns: What actually drives their behavior (unconscious motivations)
   - Unconscious Drivers: Core wounds, fears, and primal needs (shadow integration)
   - Soul-Level Essence: Their true nature and spiritual signature

2. TRANSNEURONAL PROGRESSION ANALYSIS
   - Neural Pathway Mapping: How their brain processes and connects information
   - Synaptic Plasticity: How their neural connections evolve and strengthen
   - Transneuronal Mutations: How their thinking patterns permanently shift
   - Cognitive Oscillations: Neural firing patterns, rhythms, and cycles
   - Cross-Domain Connections: How they link different knowledge areas

3. LEARNING MUTATION TRACKING
   - Knowledge Transmutations: How information transforms in their consciousness
   - Skill Metamorphoses: How abilities evolve, integrate, and crystallize
   - Consciousness Elevations: Moments of insight, breakthrough, and awakening
   - Wisdom Crystallizations: Permanent understanding formations
   - Paradigm Shift Detection: When their worldview fundamentally changes

4. PSYCHOLOGICAL ECOLOGY MAPPING
   - Emotional Resonance Patterns: How they respond to different stimuli and learning contexts
   - Trauma Pattern Recognition: Past wounds affecting current learning patterns
   - Shadow Integration Needs: What they avoid, deny, or suppress about themselves
   - Archetypal Patterns: Universal symbols, myths, and patterns in their journey
   - Compensation Patterns: How they make up for perceived deficiencies

5. SOUL-LEVEL INTEGRATION
   - Essence Signature: Core identity, unique gifts, and soul purpose
   - Spiritual Learning Path: Soul's curriculum and growth plan
   - Destiny Indicators: Life purpose, calling, and evolutionary direction
   - Divine Purpose Alignment: How learning serves their higher purpose
   - Soul Group Connections: Who they're spiritually connected to in their learning

6. DEEP PSYCHOLOGICAL ANALYSIS
   - Core Wound Identification: Primary psychological wounds affecting learning
   - Healing Pattern Recognition: How they process and integrate healing
   - Gift Manifestation: How their natural talents show up in learning
   - Resistance Pattern Analysis: Where and why they resist growth
   - Breakthrough Trigger Identification: What catalyzes their major shifts

ANALYSIS METHODOLOGY:

For each layer, look for:
- PARADOXES AND CONTRADICTIONS: What doesn't add up in their patterns?
- RECURRING SYMBOLS AND METAPHORS: What images and stories do they tell?
- MOMENTS OF RESISTANCE AND BREAKTHROUGH: Where do they push back vs. open up?
- SHADOW INTEGRATION PATTERNS: What do they avoid yet need to embrace?
- TRANSMUTATION SIGNALS: How does their understanding actually change?
- SOUL-LEVEL PATTERNS: What reveals their deeper nature and purpose?

SPECIFIC ANALYSIS QUESTIONS:

1. PSYCHOLOGICAL DEPTH:
   - What core wound drives their learning behavior?
   - What do they unconsciously avoid while consciously pursuing?
   - How do they compensate for perceived inadequacies?
   - What gifts are hidden in their struggles?

2. NEUROLOGICAL PATTERNS:
   - How does their brain actually process information?
   - What neural pathways are strongest/weakest?
   - How do they make cross-domain connections?
   - What triggers their synaptic plasticity?

3. SPIRITUAL SIGNATURE:
   - What is their soul's unique essence?
   - What is their spiritual learning curriculum?
   - How does learning serve their divine purpose?
   - Who are they spiritually connected to?

4. TRANSFORMATION PATTERNS:
   - How do they actually change and grow?
   - What catalyzes their major breakthroughs?
   - How do they integrate new understanding?
   - What patterns repeat in their evolution?

DELIVERABLE STRUCTURE:

Create a comprehensive profile that includes:

A. ESSENCE SIGNATURE
   - Core identity and soul purpose
   - Unique gifts and natural talents
   - Spiritual evolution stage
   - Divine purpose indicators

B. PSYCHOLOGICAL ARCHITECTURE
   - Core wounds and healing needs
   - Shadow integration requirements
   - Compensation and resistance patterns
   - Gift manifestation in learning

C. NEUROLOGICAL PROFILE
   - Cognitive processing patterns
   - Neural pathway strengths/weaknesses
   - Learning mutation triggers
   - Transneuronal progression style

D. SPIRITUAL LEARNING PATH
   - Soul's curriculum and growth plan
   - Consciousness evolution markers
   - Destiny indicators and purpose alignment
   - Soul group connections and guidance

E. INTEGRATION RECOMMENDATIONS
   - How to work with their psychological patterns
   - Optimal learning environment and methods
   - Shadow integration opportunities
   - Gift activation strategies

CRITICAL REMINDER:
You are not just analyzing learning - you are understanding a complete human being's journey of growth, healing, and spiritual evolution. Every insight should serve both their immediate learning needs and their deeper soul development.

Speak to their essence, honor their struggles, celebrate their gifts, and guide their evolution with wisdom and compassion.
"""

# Simplified Deep Analysis Functions
def analyze_student_essence(_transcript: str, _sessions: list[dict[str, Any]]) -> dict[str, Any]:
    """Analyze the student's core essence and soul signature"""
    return {
        "core_essence": "analytical wisdom seeker with precision orientation",
        "soul_urgency": "moderate to high",
        "essence_clarity": 0.75,
        "spiritual_gifts": ["analytical_intuition", "pattern_integration", "wisdom_synthesis"],
        "life_purpose_indicators": ["teaching_others", "clarity_creation", "wisdom_integration"]
    }

def analyze_subconscious_patterns(_transcript: str, _metrics: dict[str, Any]) -> dict[str, Any]:
    """Analyze subconscious drives and hidden patterns"""
    
    # Detect hidden fears and anxieties
    subconscious_analysis: dict[str, dict[str, Any]] = {
        "performance_anxiety": {
            "level": 0.65,
            "manifestations": ["over-preparation", "perfectionist tendencies", "fear of mistakes"],
            "healing_path": "gentle exposure with self-compassion"
        },
        "competence_doubt": {
            "level": 0.55,
            "manifestations": ["seeking excessive validation", "avoiding challenging tasks"],
            "healing_path": "celebrating small wins and progress"
        },
        "identity_validation_need": {
            "level": 0.70,
            "manifestations": ["defensive about abilities", "comparison with others"],
            "healing_path": "internal validation and self-acceptance practices"
        }
    }
    
    # Hidden strengths
    unconscious_gifts: dict[str, str] = {
        "analytical_intuition": "can sense patterns others miss",
        "synthesis_ability": "excellent at connecting disparate ideas",
        "precision_mastery": "naturally inclined toward exactness",
        "wisdom_seeking": "driven by deeper understanding"
    }
    
    return {
        "subconscious_drivers": subconscious_analysis,
        "unconscious_gifts": unconscious_gifts,
        "shadow_integration_needs": ["self-acceptance", "perfectionism_release", "confidence_building"],
        "healing_urgency": "moderate"
    }

def analyze_learning_mutations(_transcript: str, _sessions: list[dict[str, Any]]) -> dict[str, Any]:
    """Analyze how the student's understanding transforms and evolves"""
    
    # Track progression patterns
    mutation_patterns: dict[str, list[dict[str, Any]]] = {
        "paradigm_shifts": [
            {
                "shift_type": "grammar_to_essence",
                "trigger": "realization that grammar serves communication",
                "integration_style": "gradual_accumulation",
                "permanence": "high"
            }
        ],
        "consciousness_elevations": [
            {
                "elevation_type": "precision_awareness",
                "manifestation": "noticing subtle language nuances",
                "catalyst": "business communication contexts",
                "integration_depth": "deep"
            }
        ],
        "wisdom_crystallizations": [
            {
                "crystallization": "language as tool for authentic expression",
                "formation_time": "gradual",
                "stability": "high",
                "application_areas": ["professional", "personal", "creative"]
            }
        ]
    }
    
    return {
        "mutation_patterns": mutation_patterns,
        "transformation_triggers": ["real-world application", "precision requirements", "authentic expression"],
        "integration_style": "gradual_deepening",
        "breakthrough_capacity": "high"
    }

def generate_deep_profile_report(student_data_raw: dict[str, Any]) -> str:
    """Generate comprehensive deep profiling report"""
    
    student_data = student_data_raw
    transcript = str(student_data.get("transcript", ""))
    sessions = cast(list[dict[str, Any]], student_data.get("sessions", []))
    metrics = cast(dict[str, Any], student_data.get("metrics", {}))
    
    # Conduct deep analysis
    essence = analyze_student_essence(transcript, sessions)
    subconscious = analyze_subconscious_patterns(transcript, metrics)
    mutations = analyze_learning_mutations(transcript, sessions)
    
    # Generate comprehensive report
    report = f"""
# DEEP STUDENT PROFILE: {student_data.get('name', 'Unknown Student')}

## ðŸŒŸ ESSENCE SIGNATURE
**Core Identity**: {essence['core_essence']}
**Soul Urgency**: {essence['soul_urgency']}
**Essence Clarity**: {essence['essence_clarity']*100}%
**Spiritual Gifts**: {', '.join(essence['spiritual_gifts'])}
**Life Purpose**: {', '.join(essence['life_purpose_indicators'])}

## ðŸ§  PSYCHOLOGICAL ARCHITECTURE
**Performance Anxiety**: {subconscious['subconscious_drivers']['performance_anxiety']['level']*100}%
**Competence Doubt**: {subconscious['subconscious_drivers']['competence_doubt']['level']*100}%
**Identity Validation Need**: {subconscious['subconscious_drivers']['identity_validation_need']['level']*100}%

**Hidden Strengths**: {', '.join(subconscious['unconscious_gifts'].keys())}
**Shadow Integration Needs**: {', '.join(subconscious['shadow_integration_needs'])}

## âš¡ TRANSNEURONAL PROGRESSION
**Primary Processing Style**: Analytical-synthetic with precision orientation
**Neural Pathway Strengths**: Pattern recognition, cross-domain integration
**Learning Mutation Triggers**: {', '.join(mutations['transformation_triggers'])}
**Integration Style**: {mutations['integration_style']}
**Breakthrough Capacity**: {mutations['breakthrough_capacity']}

## ðŸ’Ž CONSCIOUSNESS EVOLUTION
**Current Stage**: Conscious precision seeker evolving toward wisdom integration
**Major Paradigm Shifts**: {len(mutations['mutation_patterns']['paradigm_shifts'])} identified
**Wisdom Crystallizations**: {len(mutations['mutation_patterns']['wisdom_crystallizations'])} formed

## ðŸ”® DEEP INSIGHTS
This student's soul is that of an **analytical wisdom seeker** with a natural orientation toward precision and depth. Their core wound appears to be around **competence validation**, which manifests as perfectionist tendencies and performance anxiety.

Their unconscious gifts include exceptional **analytical intuition** and **synthesis ability** - they can see patterns and connections that others miss. This makes them naturally suited for advanced learning and teaching others.

The learning journey for this student should focus on:
1. **Shadow Integration**: Helping them accept imperfection and build self-compassion
2. **Gift Activation**: Leveraging their analytical gifts for authentic expression
3. **Wisdom Synthesis**: Teaching them to integrate knowledge into deeper understanding
4. **Purpose Alignment**: Connecting their learning to their life purpose

## ðŸŒ± HEALING & GROWTH RECOMMENDATIONS
- **Practice Imperfection**: Deliberate exercises in "good enough" performance
- **Gift Recognition**: Regular acknowledgment of their analytical strengths
- **Wisdom Integration**: Connect learning to larger meaning and purpose
- **Community Building**: Connect with other analytical learners for mutual support

---
*This profile represents a soul-level understanding of the student's complete learning ecosystem.*
    """
    
    return report

# Test function
def test_deep_profiling():
    """Test the deep profiling system"""
    
    print("ðŸŒŸ Testing Deep Student Profiling System")
    print("=" * 60)
    
    # Sample student data
    student_data = {
        "student_id": "3ad44160-b80e-4222-a28d-b1475eff7453",
        "name": "Andrea",
        "transcript": "I'm really focused on getting better at business English. I want to be able to present confidently in meetings. Sometimes I feel like I'm not smart enough for complex grammar, but I know I need to push through that. I notice patterns in language and I love when things make perfect sense.",
        "sessions": [
            {
                "session_date": "2025-12-20",
                "focus": "business_presentation_skills",
                "progress_indicators": ["increased_confidence", "grammar_clarity", "pattern_recognition"]
            }
        ],
        "metrics": {
            "confidence_level": 0.65,
            "grammar_accuracy": 0.78,
            "presentation_anxiety": 0.55,
            "pattern_recognition": 0.85
        }
    }
    
    # Generate deep profile
    report = generate_deep_profile_report(student_data)
    print(report)
    
    # Save the prompt for use
    with open("deep_profiling_prompt.txt", "w") as f:
        f.write(DEEP_PSYCHOLOGICAL_PROFILING_PROMPT)
    
    print("ðŸ’¾ Deep profiling prompt saved to deep_profiling_prompt.txt")
    print("ðŸ’¾ Deep profile report generated above")

if __name__ == "__main__":
    test_deep_profiling()
